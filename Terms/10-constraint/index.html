
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../09-inductive/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Constraint Universe - Saki-Lang</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#constraint-universe" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Saki-Lang" class="md-header__button md-logo" aria-label="Saki-Lang" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3h2v2H5v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5h2v2H5c-1.07-.27-2-.9-2-2v-4a2 2 0 0 0-2-2H0v-2h1a2 2 0 0 0 2-2V5a2 2 0 0 1 2-2m14 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2 2 2 0 0 1-2-2V5h-2V3zm-7 12a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-4 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m8 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Saki-Lang
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Constraint Universe
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Saki-Lang" class="md-nav__button md-logo" aria-label="Saki-Lang" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3h2v2H5v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5h2v2H5c-1.07-.27-2-.9-2-2v-4a2 2 0 0 0-2-2H0v-2h1a2 2 0 0 0 2-2V5a2 2 0 0 1 2-2m14 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2 2 2 0 0 1-2-2V5h-2V3zm-7 12a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m-4 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1m8 0a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1"/></svg>

    </a>
    Saki-Lang
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-keywords/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keywords and Identifiers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-mltt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Martin-Löf Type Theory
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-proofs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Construct Formal Proofs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-overloading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ad-Hoc Polymorphism (Overloading)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-subtyping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subtyping and Algebraic Subtyping
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Definition
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Definition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Definition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Definition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Definition/01-decorator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decorator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Terms
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Terms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-lambda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Function (Lambda)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-dependent-pi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependent Pi (Function) Type
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-expr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expressions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-sum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sum Type
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-pair/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Product Type (Pair) and Dependent Sigma Type
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-record/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Record
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-adt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Algebraic Datatype
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-inductive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inductive Type with Indices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Constraint Universe
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Constraint Universe
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#universe-structure-and-predicates" class="md-nav__link">
    <span class="md-ellipsis">
      Universe Structure and Predicates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typing-rules-for-universes" class="md-nav__link">
    <span class="md-ellipsis">
      Typing Rules for Universes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#universe-hierarchy-and-subtyping" class="md-nav__link">
    <span class="md-ellipsis">
      Universe Hierarchy and Subtyping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subtyping-properties-in-universes" class="md-nav__link">
    <span class="md-ellipsis">
      Subtyping Properties in Universes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependent-universes" class="md-nav__link">
    <span class="md-ellipsis">
      Dependent Universes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contract-universe-binding" class="md-nav__link">
    <span class="md-ellipsis">
      Contract Universe Binding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-defining-functions-with-contract-universes" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Defining Functions with Contract Universes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#universe-structure-and-predicates" class="md-nav__link">
    <span class="md-ellipsis">
      Universe Structure and Predicates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typing-rules-for-universes" class="md-nav__link">
    <span class="md-ellipsis">
      Typing Rules for Universes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#universe-hierarchy-and-subtyping" class="md-nav__link">
    <span class="md-ellipsis">
      Universe Hierarchy and Subtyping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subtyping-properties-in-universes" class="md-nav__link">
    <span class="md-ellipsis">
      Subtyping Properties in Universes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependent-universes" class="md-nav__link">
    <span class="md-ellipsis">
      Dependent Universes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contract-universe-binding" class="md-nav__link">
    <span class="md-ellipsis">
      Contract Universe Binding
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-defining-functions-with-contract-universes" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Defining Functions with Contract Universes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="constraint-universe">Constraint Universe</h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature is not yet implemented or not fully supported in the current version of Saki interpreter/REPL.</p>
</div>
<p>In <strong>Saki</strong>, universes are used to organize types into hierarchies, particularly when dealing with <strong>contract universes</strong>, which enforce certain behaviors or constraints on types. A <strong>universe</strong> in Saki is essentially a type whose elements are themselves types, constrained by certain contracts or predicates. This design closely aligns with <strong>Martin-Löf Type Theory (MLTT)</strong>, where universes are structured collections of types that satisfy specific conditions. Contract universes in Saki allow types to declare behaviors through contracts, enforcing rules and conditions on how types interact.</p>
<h4 id="universe-structure-and-predicates">Universe Structure and Predicates</h4>
<p>In <strong>MLTT</strong>, a universe <span class="arithmatex">\(\mathcal{U}_P\)</span> is the collection of all types <code>T</code> that satisfy a given predicate <code>P(T)</code>. In Saki, this idea extends to <strong>contract universes</strong>, where types belong to universes by fulfilling contracts. These contracts specify behaviors (like implementing certain methods), which serve as predicates for inclusion in the universe.</p>
<p>For instance, consider the following contract universe in Saki:</p>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">universe</span><span class="w"> </span><span class="ss">&#39;Printable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contract</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="n">require</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="n">self</span><span class="p">):</span><span class="w"> </span><span class="nc">String</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">}</span>
</span></code></pre></div>
<ul>
<li>The <strong><code>'Printable</code></strong> universe contains all types that satisfy the contract by implementing a <code>print</code> method that returns a <code>String</code>.</li>
</ul>
<p>The relationship between types and the universe <span class="arithmatex">\(\mathcal{U}_P\)</span> can be expressed as follows:
$$
T : \mathcal{U}_P \iff P(T)
$$
Where <span class="arithmatex">\(P(T)\)</span> is a predicate that holds for a type <span class="arithmatex">\(T\)</span>, meaning <span class="arithmatex">\(T\)</span> satisfies the contract (or conditions) required by <span class="arithmatex">\(P\)</span>.</p>
<h4 id="typing-rules-for-universes">Typing Rules for Universes</h4>
<p>The typing rule for contract universes ensures that types are included in the universe only if they satisfy the required contract. In Saki, this is reflected in the following general typing rule:
$$
\frac{\Gamma \vdash T : \mathcal{U} \quad P(T)}{\Gamma \vdash T : \mathcal{U}_P}
$$
This rule states that:</p>
<ul>
<li>If a type <span class="arithmatex">\(T\)</span> belongs to a base universe <span class="arithmatex">\(\mathcal{U}\)</span> and satisfies the predicate <span class="arithmatex">\(P(T)\)</span> (such as implementing required contract methods), then <span class="arithmatex">\(T\)</span> belongs to the universe <span class="arithmatex">\(\mathcal{U}_P\)</span>, where <span class="arithmatex">\(P\)</span> represents the contract.</li>
</ul>
<h4 id="universe-hierarchy-and-subtyping">Universe Hierarchy and Subtyping</h4>
<p>Saki employs a <strong>hierarchical universe system</strong> similar to that of <strong>MLTT</strong>, where universes can be ordered by subtyping. One universe is a <strong>subtype</strong> of another if every type in the first universe satisfies the conditions of the second. This hierarchy is based on the predicates enforced by each universe.</p>
<p>For instance, consider the following two contract universes:</p>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">universe</span><span class="w"> </span><span class="ss">&#39;Add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contract</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="n">require</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">lhs</span><span class="p">:</span><span class="w"> </span><span class="nc">Self</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">:</span><span class="w"> </span><span class="nc">Self</span><span class="p">):</span><span class="w"> </span><span class="nc">String</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">}</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">universe</span><span class="w"> </span><span class="ss">&#39;Mul</span><span class="p">(</span><span class="nc">A</span><span class="w"> </span><span class="nc">R</span><span class="p">:</span><span class="w"> </span><span class="ss">&#39;Type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contract</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="n">require</span><span class="w"> </span><span class="n">mul</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">:</span><span class="w"> </span><span class="nc">A</span><span class="p">):</span><span class="w"> </span><span class="nc">R</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="p">}</span>
</span></code></pre></div>
<ul>
<li>The <code>'Add</code> universe includes all types that implement an <code>add</code> method, while the <code>'Mul</code> universe contains types that implement a <code>mul</code> method for multiplication.</li>
</ul>
<p>The <strong>subtyping relation</strong> between universes can be expressed as: </p>
<div class="arithmatex">\[
\mathcal{U}_{P_1} &lt;: \mathcal{U}_{P_2} \iff \forall T \,.\, (T : \mathcal{U}_{P_1} \implies T : \mathcal{U}_{P_2})
\]</div>
<p>This means that a universe <span class="arithmatex">\(\mathcal{U}_{P_1}\)</span> is a subtype of another universe <span class="arithmatex">\(\mathcal{U}_{P_2}\)</span> if every type in <span class="arithmatex">\(\mathcal{U}_{P_1}\)</span> also satisfies the predicate <span class="arithmatex">\(P_2\)</span>. In other words, if a type satisfies the conditions of universe <span class="arithmatex">\(P_1\)</span>, it must also satisfy the conditions of universe <span class="arithmatex">\(P_2\)</span>.</p>
<h4 id="subtyping-properties-in-universes">Subtyping Properties in Universes</h4>
<p>The subtyping relation between universes follows several important properties, ensuring consistency in the hierarchy:</p>
<ol>
<li>
<p><strong>Reflexivity</strong>:
Every universe is a subtype of itself:
$$
\mathcal{U}_P &lt;: \mathcal{U}_P
$$
This holds because <span class="arithmatex">\(P(T) \implies P(T)\)</span> for any predicate <span class="arithmatex">\(P\)</span>.</p>
</li>
<li>
<p><strong>Antisymmetry</strong>:
If two universes <span class="arithmatex">\(\mathcal{U}_{P_1}\)</span> and <span class="arithmatex">\(\mathcal{U}_{P_2}\)</span> are mutually subtypes of each other, they are equal:</p>
</li>
</ol>
<div class="arithmatex">\[
(\mathcal{U}_{P_1} &lt;: \mathcal{U}_{P_2} \land \mathcal{U}_{P_2} &lt;: \mathcal{U}_{P_1}) \implies \mathcal{U}_{P_1} = \mathcal{U}_{P_2}
\]</div>
<ol>
<li><strong>Transitivity</strong>:
If universe <span class="arithmatex">\(\mathcal{U}_{P_1}\)</span> is a subtype of <span class="arithmatex">\(\mathcal{U}_{P_2}\)</span>, and <span class="arithmatex">\(\mathcal{U}_{P_2}\)</span> is a subtype of <span class="arithmatex">\(\mathcal{U}_{P_3}\)</span>, then <span class="arithmatex">\(\mathcal{U}_{P_1}\)</span> is a subtype of <span class="arithmatex">\(\mathcal{U}_{P_3}\)</span>:</li>
</ol>
<div class="arithmatex">\[
(\mathcal{U}_{P_1} &lt;: \mathcal{U}_{P_2} \land \mathcal{U}_{P_2} &lt;: \mathcal{U}_{P_3}) \implies \mathcal{U}_{P_1} &lt;: \mathcal{U}_{P_3}
\]</div>
<h4 id="dependent-universes">Dependent Universes</h4>
<p>In <strong>Saki</strong>, universes can also be <strong>dependent types</strong>, where the universe's constraints (predicates) depend on a parameter. For example, in the contract universe <code>'Mul</code>, the multiplication contract depends on two parameters, <code>A</code> and <code>R</code>, where <code>A</code> is the type being multiplied and <code>R</code> is the result type:</p>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">universe</span><span class="w"> </span><span class="ss">&#39;Mul</span><span class="p">(</span><span class="nc">A</span><span class="w"> </span><span class="nc">R</span><span class="p">:</span><span class="w"> </span><span class="ss">&#39;Type</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contract</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="n">require</span><span class="w"> </span><span class="n">mul</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">:</span><span class="w"> </span><span class="nc">A</span><span class="p">):</span><span class="w"> </span><span class="nc">R</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="p">}</span>
</span></code></pre></div>
<p>This can be formalized as a <strong>dependent universe</strong>:</p>
<div class="arithmatex">\[
\Pi_{R:\mathcal{U}_1}. \Pi_{A: \mathcal{U}_0} \,.\, (A \rightarrow R)
\]</div>
<p>Here, the universe for types satisfying the multiplication contract is dependent on the types <code>A</code> and <code>R</code>.</p>
<h4 id="contract-universe-binding">Contract Universe Binding</h4>
<p>Just like types and values, contract universes in Saki can be bound to a <code>let</code> expression. For example:</p>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">let</span><span class="w"> </span><span class="ss">&#39;Mul</span><span class="p">:</span><span class="w"> </span><span class="ss">&#39;Type</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">&#39;Type</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">#</span><span class="nc">Universe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="nc">A</span><span class="w"> </span><span class="nc">R</span><span class="p">:</span><span class="w"> </span><span class="ss">&#39;Type</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">contract</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">        </span><span class="n">decl</span><span class="w"> </span><span class="n">mul</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">:</span><span class="w"> </span><span class="nc">A</span><span class="p">):</span><span class="w"> </span><span class="nc">R</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this case:</p>
<ul>
<li>The <code>let</code> expression binds a contract universe <code>'Mul</code> to a type-level function.</li>
<li>The contract ensures that any type belonging to this universe implements a <code>mul</code> function, with the input type <code>A</code> and the result type <code>R</code>.</li>
</ul>
<h4 id="example-defining-functions-with-contract-universes">Example: Defining Functions with Contract Universes</h4>
<p>Once contract universes are defined, they can be used to enforce specific behaviors within functions. Consider the following example:</p>
<div class="language-scala highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">square</span><span class="p">[</span><span class="nc">R</span><span class="p">:</span><span class="w"> </span><span class="ss">&#39;Type</span><span class="p">,</span><span class="w"> </span><span class="nc">A</span><span class="p">:</span><span class="w"> </span><span class="ss">&#39;Mul</span><span class="p">(</span><span class="nc">A</span><span class="p">,</span><span class="w"> </span><span class="nc">R</span><span class="p">)](</span><span class="n">self</span><span class="p">:</span><span class="w"> </span><span class="nc">A</span><span class="p">):</span><span class="w"> </span><span class="nc">R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">mul</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
</span></code></pre></div>
<ul>
<li>This function takes a value <code>self</code> of type <code>A</code> that belongs to the <code>'Mul</code> contract universe, meaning <code>A</code> must implement the <code>mul</code> method.</li>
<li>The function returns <code>R</code>, the result of multiplying <code>self</code> by itself using the <code>mul</code> method.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "navigation.expand"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/editor.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>